## 栈(Stack)与堆(Heap)
- 值是位于栈上还是堆上非常重要, 因为这会影响程序的行为和性能
- 栈和堆的核心目标就是为程序在运行时提供可供使用的内存空间
### 栈
- 因为先进后出的实现方式，栈中的所有数据都必须占用已知且固定大小的内存空间，假设数据大小是未知的，那么在取出数据时，你将无法取到你想要的数据
### 堆
- 对于大小未知或者可能变化的数据，我们需要将它存储在堆上
#### 在堆上分配内存(allocating)
- 操作系统在堆的某处找到一块足够大的空位，把它标记为已使用，并返回一个表示该位置地址的指针，该指针会被推入栈中(因为指针的大小是已知且固定的)
  - 在后续使用过程中，将通过栈中的指针，来获取数据在堆上的实际内存位置，进而访问该数据
### 性能区别
#### 在栈上分配内存比在堆上分配内存要快
- 因为入栈时操作系统无需进行函数调用（或更慢的系统调用）来分配新的空间，只需要将新数据放入栈顶即可
  - 相比之下，在堆上分配内存则需要更多的工作，这是因为操作系统必须首先找到一块足够存放数据的内存空间，接着做一些记录为下一次分配做准备
    - 如果当前进程分配的内存页不足时，还需要进行系统调用来申请更多内存
### 总结
- 当代码调用一个函数时，传递给函数的参数（包括可能指向堆上数据的指针和函数的局部变量）依次被压入栈中
- 当函数调用结束时，这些值将被从栈中按照相反的顺序依次移除
- 因为堆上的数据缺乏组织，因此跟踪这些数据何时分配和释放是非常重要的，否则堆上的数据将产生**内存泄漏**(这些数据将永远无法被回收)。这就是 Rust **所有权**系统提供的强大保障

## 所有权
### [原则](https://course.rs/basic/ownership/ownership.html#%E6%89%80%E6%9C%89%E6%9D%83%E5%8E%9F%E5%88%99)
1. Rust 中每一个值都被一个变量所拥有，该变量被称为值的所有者 
2. 一个值同时只能被一个变量所拥有，或者说一个值只能拥有一个所有者 
3. 当所有者(变量)离开作用域范围时，这个值将被丢弃(drop)
### 作用
- 避免了内存的不安全性，但是通过转移所有权的方式获取一个值，那会让程序变得复杂。Rust 通过 借用(Borrowing) 来使用某个变量的指针或者引用